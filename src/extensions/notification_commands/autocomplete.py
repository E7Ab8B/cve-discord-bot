from __future__ import annotations

from typing import TYPE_CHECKING

from discord import app_commands as ac

from utils.label import get_label_names

if TYPE_CHECKING:
    import discord


async def label_autocomplete(
    interaction: discord.Interaction,
    current: str,
) -> list[ac.Choice[str]]:
    """List of labels from db that are used for app command autocomplete."""
    label_names = await get_label_names(limit=12)
    if label_names is None:
        return []

    return [ac.Choice(name=name, value=name) for name in label_names if current.lower() in name.lower()]
